!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.clamp=(t,e,i)=>t>=e&&t<=i?t:t<e?e:i,t.map=(t,e,i,s,n)=>(t-e)/(i-e)*(n-s)+s,t.TWO_PI=2*Math.PI}(e.MathUtils||(e.MathUtils={}))},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,o){function r(t){try{h(s.next(t))}catch(t){o(t)}}function a(t){try{h(s.throw(t))}catch(t){o(t)}}function h(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(r,a)}h((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(2);document.body.style.padding="0",document.body.style.margin="0",document.addEventListener("DOMContentLoaded",()=>s(this,void 0,void 0,function*(){if(-1!==location.search.indexOf("?b=")){const t=location.search.split("?b=")[1],e=yield n.EaterAnalysis.fromBlob(t),i=e.domElement;i.style.display="block",document.body.appendChild(i),e.start()}}))},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,o){function r(t){try{h(s.next(t))}catch(t){o(t)}}function a(t){try{h(s.throw(t))}catch(t){o(t)}}function h(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(r,a)}h((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(0),o=i(3),r=i(4);class a{constructor(t,e){this.paused=!0,this.params=t,this.brain=new Function(...e.args,e.body),this.cnv=document.createElement("canvas"),this.cnv.width=window.innerWidth,this.cnv.height=window.innerHeight,this.ctx=this.cnv.getContext("2d"),this.food_pos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]),window.addEventListener("resize",()=>this.on_resize()),this.eater=new r.Eater(o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]),Math.random()*Math.PI*2,0)}on_resize(){this.cnv.width=window.innerWidth,this.cnv.height=window.innerHeight,(this.cnv.width<this.food_pos.x||this.cnv.height<this.food_pos.y)&&(this.food_pos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height]))}update(){this.tick(),this.render(),this.paused||requestAnimationFrame(()=>this.update())}pause(){this.paused=!0}start(){this.paused=!1,this.update()}tick(){this.eater.position.dist(this.food_pos)<=(this.params.eater_size+this.params.food_size)/2&&(this.food_pos=o.Vector2D.rand().hadamard([this.cnv.width,this.cnv.height])),this.eater.food_dir=this.food_pos.sub(this.eater.position.normalize());const[t,e]=this.brain([Math.cos(this.eater.angle),Math.sin(this.eater.angle),this.eater.food_dir.x,this.eater.food_dir.y]),i=n.MathUtils.clamp(t-e,-this.params.max_turn_rate,this.params.max_turn_rate);this.eater.angle+=i,this.eater.lookat=new o.Vector2D(Math.cos(this.eater.angle),Math.sin(this.eater.angle)),this.eater.position.plus(this.eater.lookat.times(this.params.max_speed)),this.params.wrap_borders?(this.eater.position.x>this.cnv.width&&(this.eater.position.x=0),this.eater.position.x<0&&(this.eater.position.x=this.cnv.width),this.eater.position.y>this.cnv.height&&(this.eater.position.y=0),this.eater.position.y<0&&(this.eater.position.y=this.cnv.height)):(this.eater.position.x>this.cnv.width&&(this.eater.position.x=this.cnv.width),this.eater.position.x<0&&(this.eater.position.x=0),this.eater.position.y>this.cnv.height&&(this.eater.position.y=this.cnv.height),this.eater.position.y<0&&(this.eater.position.y=0))}render(){this.ctx.clearRect(0,0,this.cnv.width,this.cnv.height),this.drawFood(),this.drawEeater()}drawFood(){const t=this.params.food_size;this.ctx.fillStyle="rgb(52, 73, 94)",this.ctx.beginPath(),this.ctx.fillRect(this.food_pos.x-t/2,this.food_pos.y-t/2,t,t),this.ctx.fill()}drawEeater(){this.ctx.fillStyle="rgb(22, 160, 133)",this.ctx.beginPath();const t=this.eater.lookat.times(this.params.eater_size).add(this.eater.position),e=t.sub(this.eater.position).angle(),i=Math.PI/1.3,s=new o.Vector2D(Math.cos(e+i),Math.sin(e+i)),n=new o.Vector2D(Math.cos(e-i),Math.sin(e-i)),r=this.eater.position.add(s.times(this.params.eater_size)),a=this.eater.position.add(n.times(this.params.eater_size));this.ctx.moveTo(r.x,r.y),this.ctx.lineTo(t.x,t.y),this.ctx.lineTo(a.x,a.y),this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.moveTo(this.eater.position.x,this.eater.position.y);const h=this.eater.position.add(this.eater.food_dir.times(2*this.params.eater_size));this.ctx.lineTo(h.x,h.y),this.ctx.stroke()}get domElement(){return this.cnv}static fromBlob(t){return new Promise((e,i)=>s(this,void 0,void 0,function*(){try{const s=JSON.parse(yield(yield fetch(t.toString())).text());console.log(s),e(new a(s.params,s.brain))}catch(t){i(t)}}))}}e.EaterAnalysis=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t,e){this.x=t,this.y=e}add(t){return new s(this.x+t.x,this.y+t.y)}sub(t){return new s(this.x-t.x,this.y-t.y)}plus(t){this.x+=t.x,this.y+=t.y}minus(t){this.x-=t.x,this.y-=t.y}dot(t){return this.x*t.x+this.y*t.y}hadamard(t){return t instanceof s?new s(this.x*t.x,this.y*t.y):new s(this.x*t[0],this.y*t[1])}norm(){return Math.pow(this.dot(this),.5)}norm_sq(){return this.dot(this)}times(t){return new s(this.x*t,this.y*t)}normalize(){return this.times(1/this.norm())}dist(t){return this.sub(t).norm()}dist_sq(t){return this.sub(t).norm_sq()}map(t){return new s(t(this.x),t(this.y))}angle(){return Math.atan2(this.y,this.x)}toArray(){return[this.x,this.y]}fromArray(t){return new s(t[0],t[1])}static fill(t){return new s(t,t)}static zeroes(){return s.fill(0)}static ones(){return s.fill(1)}static rand(){return new s(Math.random(),Math.random())}static clone(t){return new s(t.x,t.y)}}e.Vector2D=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.Eater=class{constructor(t,e,i){this._pos=t,this._angle=e,this.chromosomeIdx=i}getChromosomeIdx(){return this.chromosomeIdx}get position(){return this._pos}set position(t){this._pos=t}get angle(){return this._angle}set angle(t){this._angle=t%s.MathUtils.TWO_PI}}}]);